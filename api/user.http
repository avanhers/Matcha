POST  http://localhost/api/auth/inscription HTTP/1.1
content-type: application/json

{
    "email": "jules.jaegle@gmail.com",
    "name": "jules",
    "firstname": "jules",
    "username": "jules",
    "password": "toto"
}
###
POST  http://localhost/api/user/updatePassword HTTP/1.1
content-type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNjkxMTQzLCJleHAiOjE2MDI2OTEyMDN9.F4r-RQiCnVPmAQMqzRTDQh9uy_mw1YTK1FYTS6HjODM
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNjkxODAwLCJleHAiOjE2MDI3NzgyMDB9.s8Ob_8g8Bnvw-ivfIsXQNf7fWDjwfRD3PjYtRtCHEeM

{
    "oldPassword": "Qwerty12;",
    "password": "Qwerty12;"
}
###
POST  http://localhost/api/auth/login HTTP/1.1
content-type: application/json

{
    "username": "jules",
    "password": "Qwerty12;"
}
###
POST  http://localhost/api/auth/resetPassword HTTP/1.1
content-type: application/json

{
    "userId": 201,
    "password": "Qwerty12;"
}
###
POST  http://localhost/api/user/setAvatar/10 HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNzc0NTMwLCJleHAiOjE2MDI3NzQ1OTB9.Lme6jRlyiLZr8BJqE0jtbJifghZ6kmJCGawytJXmbBQ
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNzc0NTMwLCJleHAiOjE2MDI4NjA5MzB9.ysBRU0Z8rtxGisgvsZpTIw3aRTVfx3PxF3RKANFzD7s


###
POST  http://localhost/api/auth/forgetPassword HTTP/1.1
content-type: application/json

{
    "email": "jules.jaegle@gmail.com",
    "username": "ok"
}
###
POST  http://localhost/api/user/like/toto HTTP/1.1
content-type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTYwMTk3Nzk3OCwiZXhwIjoxNjAxOTc4MDM4fQ.7NaH-hpQM8s3LFWjiq3CDUikwK60g5X_Gpel7YZKP1o
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNTg3MjIzLCJleHAiOjE2MDI2NzM2MjN9.BeG9CZ-flE-7baR4-RHXRNONS2dDe-EyjiPStcEFi88
###
POST  http://localhost/api/user/report/toto HTTP/1.1
content-type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTYwMTk3Nzk3OCwiZXhwIjoxNjAxOTc4MDM4fQ.7NaH-hpQM8s3LFWjiq3CDUikwK60g5X_Gpel7YZKP1o
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNTg3MjIzLCJleHAiOjE2MDI2NzM2MjN9.BeG9CZ-flE-7baR4-RHXRNONS2dDe-EyjiPStcEFi88
###
POST  http://localhost/api/user/block/toto HTTP/1.1
content-type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTYwMTk3Nzk3OCwiZXhwIjoxNjAxOTc4MDM4fQ.7NaH-hpQM8s3LFWjiq3CDUikwK60g5X_Gpel7YZKP1o
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNTg3MjIzLCJleHAiOjE2MDI2NzM2MjN9.BeG9CZ-flE-7baR4-RHXRNONS2dDe-EyjiPStcEFi88
###
POST  http://localhost/api/user/image/41/delete HTTP/1.1
content-type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNzc3NTUyLCJleHAiOjE2MDI3Nzc2MTJ9.ugDPRQ6SgSmtPGIybQ2eb-lu1ls_Y7_b-QjHDxLijqY
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNzc3NTUyLCJleHAiOjE2MDI4NjM5NTJ9.uzsmjs_JrqGbdJNJX59GF0lTUlmFC7QJkIeOm8e-OFk
###
POST http://localhost/api/user/location HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTgyNjgyLCJleHAiOjE2MDMxODI3NDJ9.g95oC0ccP16ADu_z9J-iTSqzeBHgLYaIRkOrBqs5rtM
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTgyNjgyLCJleHAiOjE2MDMyNjkwODJ9.GO95p57Xv8312nC2yBxsCnxd-svkRG1Fe5_V-YKn1yw
content-type: application/json

{
    "lng": 13,
    "lat": 55
}
###

GET http://localhost/api/user/location HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTgyNjgyLCJleHAiOjE2MDMxODI3NDJ9.g95oC0ccP16ADu_z9J-iTSqzeBHgLYaIRkOrBqs5rtM
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTgyNjgyLCJleHAiOjE2MDMyNjkwODJ9.GO95p57Xv8312nC2yBxsCnxd-svkRG1Fe5_V-YKn1yw
###
GET http://localhost/api/auth/canLog HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTAwODU2LCJleHAiOjE2MDMxMDA5MTZ9.T7jV3KIlxsPM5kTELHsXrP70vgRkUK3HHRW5DME2Q5s
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTAwODU2LCJleHAiOjE2MDMxODcyNTZ9.mXWoslsTVStfwGTPj2XWXcQHRwq-Af9P6evRHAIWYGc
###
GET http://localhost/api/user/images HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTAwNTgyLCJleHAiOjE2MDMxMDA2NDJ9.1NEt6H1RpqTn1-tPClqC2T7DG4NMjcKObfiagC6IJig
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTAwNTgyLCJleHAiOjE2MDMxODY5ODJ9.zpU1W0hLDrHpKu1PFl1ZbriwQaagm140lvUdq6Ob2Fs
###
GET http://localhost/api/user/avatar HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyODUxOTg0LCJleHAiOjE2MDI4NTIwNDR9.sTmleqKdz8gjciqnoSsNCFQ0umwP-bMPQy2qHv7B4gg
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyODUxOTg0LCJleHAiOjE2MDI5MzgzODR9.O5yWs61dNoubOOrLdvwTMjlCvocezNoyzL1cG9ZBoSA
###
GET http://localhost/api/user/tags HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTYwMTk3Nzk3OCwiZXhwIjoxNjAxOTc4MDM4fQ.7NaH-hpQM8s3LFWjiq3CDUikwK60g5X_Gpel7YZKP1o
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNTg4Nzc4LCJleHAiOjE2MDI2NzUxNzh9.Oiv2RZz3yQijJRqfQ-FnUOyShpqxbFdsWgXe8T5f2UY
###
GET http://localhost/api/user/infos HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTYwMTk3Nzk3OCwiZXhwIjoxNjAxOTc4MDM4fQ.7NaH-hpQM8s3LFWjiq3CDUikwK60g5X_Gpel7YZKP1o
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNTg4Nzc4LCJleHAiOjE2MDI2NzUxNzh9.Oiv2RZz3yQijJRqfQ-FnUOyShpqxbFdsWgXe8T5f2UY
###
GET http://localhost/api/matches?perPage=15&ageMax=24&tags[0]=1&tags[1]=&tags[2]=1&tags[3]=&ageMin=5&orderBy=DESC HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTgyNjgyLCJleHAiOjE2MDMxODI3NDJ9.g95oC0ccP16ADu_z9J-iTSqzeBHgLYaIRkOrBqs5rtM
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMTgyNjgyLCJleHAiOjE2MDMyNjkwODJ9.GO95p57Xv8312nC2yBxsCnxd-svkRG1Fe5_V-YKn1yw
###
GET http://localhost/api/user/likes HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMDk3NzAxLCJleHAiOjE2MDMwOTc3NjF9.Lf7-pUh5KuV3N14cNXQ_tX7JOulkobTGF03fjqTtcHU
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMDk3NzAxLCJleHAiOjE2MDMxODQxMDF9.jPEaGSppqydJdbuwE_vkQLO59BzSMIAMpzAEnRpNytk
###
GET http://localhost/api/user/matches HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMDk3NzAxLCJleHAiOjE2MDMwOTc3NjF9.Lf7-pUh5KuV3N14cNXQ_tX7JOulkobTGF03fjqTtcHU
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMDk3NzAxLCJleHAiOjE2MDMxODQxMDF9.jPEaGSppqydJdbuwE_vkQLO59BzSMIAMpzAEnRpNytk
###
GET http://localhost/api/user/views HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMDk3NzAxLCJleHAiOjE2MDMwOTc3NjF9.Lf7-pUh5KuV3N14cNXQ_tX7JOulkobTGF03fjqTtcHU
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAzMDk3NzAxLCJleHAiOjE2MDMxODQxMDF9.jPEaGSppqydJdbuwE_vkQLO59BzSMIAMpzAEnRpNytk
###
GET http://localhost/api/user/profile/toto HTTP/1.1
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTYwMTk3Nzk3OCwiZXhwIjoxNjAxOTc4MDM4fQ.7NaH-hpQM8s3LFWjiq3CDUikwK60g5X_Gpel7YZKP1o
x-refresh-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMSwiaWF0IjoxNjAyNTg3MjIzLCJleHAiOjE2MDI2NzM2MjN9.BeG9CZ-flE-7baR4-RHXRNONS2dDe-EyjiPStcEFi88
###
GET http://localhost/api/test HTTP/1.


SELECT u.username, u.age, u.sexualOrientation, u.gender, u.popularityScore, u.latitude, u.longitude, u.avatar, s.tags, t.distance, l.likedId
FROM users AS u
##Jointure pour les likes
LEFT JOIN likes as l ON l.likedId = 201 AND l.likeId = u.id
##Jointure pour les distances
INNER JOIN (SELECT a, id, c, 6371 * c as distance, longitude, latitude
            FROM (SELECT a, id, 2 * ATAN(SQRT(a) / SQRT(1 - a)) as c , longitude, latitude
                  FROM (SELECT(POW(SIN((-26.3319 - latitude) / 2),2) + COS(latitude) * 		COS(-26.3319) * POW(SIN((-160.9677 - longitude) / 2),2)) as a, longitude, latitude, id
     FROM users) t1) t2) as t ON u.id = t.id
INNER JOIN (SELECT userId, GROUP_CONCAT(tagId) as tags 
            FROM user_tag 
            WHERE tagId IN (1,3, 2, 6) GROUP BY userId) as s 
ON u.id = s.userId WHERE u.id <> 1 ORDER BY LENGTH(tags) DESC 
LIMIT 170 OFFSET 0

